; (function () {
  $(".slider__about-menu").mouseover(e => {
    const $this = $(e.currentTarget);
    const dropdown = $this.find(".slider__dropdown");

    $this.addClass("slider__about-menu--active");
    dropdown.addClass("dropdown--active");
  });

  $(".slider__about-menu").mouseout(e => {
    const $this = $(e.currentTarget);
    const dropdown = $this.find(".slider__dropdown");

    $this.removeClass("slider__about-menu--active");
    dropdown.removeClass("dropdown--active");
  });
})();; (function () {
  const sliderList = document.querySelector(".slider__list");
  const leftArrow = document.querySelector("#left");
  const rightArrow = document.querySelector("#right");

  const loop = (direction, e) => {
    e.preventDefault();

    if (direction === "right") {
      sliderList.appendChild(sliderList.firstElementChild);
    } else {
      sliderList.insertBefore(sliderList.lastElementChild, sliderList.firstElementChild);
    }
  }

  leftArrow.addEventListener("click", function (e) {
    loop("left", e);
  });

  rightArrow.addEventListener("click", function (e) {
    loop("right", e);
  });
})();; (function () {
  let myMap;
  const init = () => {
    myMap = new ymaps.Map("map", {
      center: [55.752761, 37.593950],
      zoom: 14,
      controls: [],
    });

    let coords = [
      [55.758657, 37.582835],
      [55.743057, 37.581770],
      [55.750232, 37.603689],
      [55.754585, 37.625343],
    ],
      myCollection = new ymaps.GeoObjectCollection({}, {
        draggable: false,
        iconLayout: 'default#image',
        iconImageHref: './img/icons/marker.svg',
        iconImageSize: [46, 57],
        iconImageOffset: [-35, -52]
      });

    for (let i = 0; i < coords.length; i++) {
      myCollection.add(new ymaps.Placemark(coords[i]));
    }

    myMap.geoObjects.add(myCollection);

    myMap.behaviors.disable('scrollZoom');
  };

  ymaps.ready(init);
})();; (function () {
  const blockWidth = item => {
    let itemWidth = 0;
    const screenWidth = $(window).width();
    const container = item.closest(".products-menu");
    const titlesBlocks = container.find(".products-menu__title");
    const titlesWidth = titlesBlocks.width() * titlesBlocks.length;

    const textContainer = item.find(".products-menu__container");
    const paddingLeft = parseInt(textContainer.css("padding-left"));
    const paddingRight = parseInt(textContainer.css("padding-right"));

    const isMobile = window.matchMedia("(max-width: 768px)").matches;

    if (isMobile) {
      itemWidth = screenWidth - titlesWidth;
    } else {
      itemWidth = 500;
    }

    return {
      container: itemWidth,
      textContainer: itemWidth - paddingRight - paddingLeft
    }
  }

  const closeAllMenuItem = container => {
    const items = container.find(".products-menu__item");
    const content = container.find(".products-menu__content");

    items.removeClass("active");
    content.width(0);
  }

  const openProductMenuItem = item => {
    const hiddenContent = item.find(".products-menu__content");
    const w = blockWidth(item);
    const textBlock = item.find(".products-menu__container");

    item.addClass("active");
    hiddenContent.width(w.container);
    textBlock.width(w.textContainer);
  }

  $(".products-menu__title").click(e => {
    e.preventDefault();

    const $this = $(e.currentTarget);
    const item = $this.closest(".products-menu__item");
    const itemOpened = item.hasClass("active");
    const container = $this.closest(".products-menu");

    if (itemOpened) {
      closeAllMenuItem(container);
    } else {
      closeAllMenuItem(container);
      openProductMenuItem(item);
    }
  });
})();; (function () {
  const validateField = (form, fieldsArray) => {
    fieldsArray.forEach(field => {
      field.removeClass("input-error");
      if (field.val().trim() === "") {
        field.addClass("input-error");
      }
    });

    const errorFields = form.find(".input-error");
    return errorFields.length === 0;
  }

  $(".form").submit(e => {
    e.preventDefault();

    const form = $(e.currentTarget);
    const name = form.find("[name='name']");
    const phone = form.find("[name='phone']");
    const comment = form.find("[name='comment']");
    const to = form.find("[name='to']");

    const modal = $("#modal");
    const content = modal.find(".modal__content");
    content.removeClass("error-modal");

    const isValid = validateField(form, [name, phone, comment, to]);

    if (isValid) {
      const request = $.ajax({
        url: "https://webdev-api.loftschool.com/sendmail",
        method: "post",
        data: {
          name: name.val(),
          phone: phone.val(),
          comment: comment.val(),
          to: to.val()
        }
      });

      request.done((data) => {
        content.text(data.message);
      });

      request.fail((data) => {
        const message = data.responseJSON.message;
        content.text(message);
        content.addClass("error-modal");
      });

      request.always(() => {
        $.fancybox.open({
          src: "#modal",
          type: "inline"
        });
      })
    }

  });

  $(".app-submit-modal").click(e => {
    e.preventDefault();

    $.fancybox.close();
  });
})();; (function () {
  const sections = $("section");
  const display = $(".maincontent");
  const sideMenu = $(".fixed-menu");
  const menuItems = sideMenu.find(".fixed-menu__item");

  const mobileDetect = new MobileDetect(window.navigator.userAgent);
  const isMobile = mobileDetect.mobile();

  let inScroll = false;

  sections.first().addClass("active");

  const countSectionPosition = sectionEq => {
    const position = sectionEq * -100;

    if (isNaN(position)) {
      console.error("Передано не верное значение в countSectionPosition");
      return 0;
    }
    return position;
  }

  const changeMenuThemeForSection = sectionEq => {
    const currentSection = sections.eq(sectionEq);
    const menuTheme = currentSection.attr("data-sidemenu-theme");
    const activeClass = "fixed-menu--black";

    if (menuTheme === "black") {
      sideMenu.addClass(activeClass);
    } else {
      sideMenu.removeClass(activeClass);
    }
  }

  const resetActiveClassForItem = (items, itemEq, activeClass) => {
    items.eq(itemEq).addClass(activeClass).siblings().removeClass(activeClass);
  }

  const performTransition = sectionEq => {
    if (inScroll) return;
    inScroll = true;

    const transitionOver = 1000;
    const mouseInertiaOver = 300;

    const position = countSectionPosition(sectionEq);

    changeMenuThemeForSection(sectionEq);

    display.css({
      transform: `translateY(${position}%)`
    });

    resetActiveClassForItem(sections, sectionEq, "active");
    resetActiveClassForItem(menuItems, sectionEq, "fixed-menu__item--active");

    setTimeout(() => {
      inScroll = false;
    }, transitionOver + mouseInertiaOver);
  }

  const viewportScroller = () => {
    const activeSection = sections.filter(".active");
    const nextSection = activeSection.next();
    const prevSection = activeSection.prev();

    return {
      next() {
        if (nextSection.length) {
          performTransition(nextSection.index())
        }
      },
      prev() {
        if (prevSection.length) {
          performTransition(prevSection.index())
        }
      }
    }
  }

  $(window).on("wheel", e => {
    const deltaY = e.originalEvent.deltaY;
    const scroller = viewportScroller();

    if (deltaY > 0) {
      scroller.next();
    } else if (deltaY < 0) {
      scroller.prev();
    }
  })

  $(window).on("keydown", e => {
    const tagName = e.target.tagName.toLowerCase();
    const userTypingInInputs = tagName === "input" || tagName === "textarea";
    const scroller = viewportScroller();

    if (userTypingInInputs) return;
    switch (e.keyCode) {
      case 38:
        scroller.prev();
        break;

      case 40:
        scroller.next();
        break;
    }
  })

  $(".wrapper").on("touchmove", e => e.preventDefault());

  $("[data-scroll-to]").click(e => {
    e.preventDefault();

    const $this = $(e.currentTarget);
    const target = $this.attr("data-scroll-to");
    const reqSection = $(`[data-section-id=${target}]`);

    performTransition(reqSection.index());
  })

  if (isMobile) {
    //  https://github.com/mattbryson/TouchSwipe-Jquery-Plugin
    $("body").swipe({
      swipe: function (event, direction) {
        const scroller = viewportScroller();
        let scrollDirection = "";

        if (direction === "up") scrollDirection = "next";
        if (direction === "down") scrollDirection = "prev";

        if (scrollDirection !== "") scroller[scrollDirection]();
      }
    })
  }
})()
;; (function () {
  const hamburger = document.querySelector(".hamburger");
  const overlay = document.querySelector(".overlay");
  const body = document.querySelector("body");
  const links = $(".overlay-menu__link");

  hamburger.addEventListener("click", e => {
    e.preventDefault();

    hamburger.classList.toggle("hamburger--active");
    overlay.classList.toggle("overlay--active");
    body.classList.toggle("body--active");
  });

  $(links).each((link) => {
    links.click(e => {
      $(".overlay").removeClass("overlay--active");
      $(body).removeClass("body--active");
      $(".hamburger").removeClass("hamburger--active");
    });
  });
})();/* ; (function () { */
let player;

const playerContainer = $(".player");

let eventsInit = () => {
  $(".player__start").click(e => {
    e.preventDefault();

    if (playerContainer.hasClass("paused")) {
      player.pauseVideo();
    } else {
      player.playVideo();
    }
  });

  $(".player__playback").click(e => {
    const bar = $(e.currentTarget);
    const clickedPosition = e.originalEvent.layerX;
    const newButtonPositionPercent = (clickedPosition / bar.width()) * 100;
    const newPlaybackPositionSec =
      (player.getDuration() / 100) * newButtonPositionPercent;

    $(".player__playback-button").css({
      left: `${newButtonPositionPercent}%`
    });

    player.seekTo(newPlaybackPositionSec);
  });

  $(".player__splash").click(e => {
    player.playVideo();
  })
};

const formatTime = timeSec => {
  const roundTime = Math.round(timeSec);

  const minutes = addZero(Math.floor(roundTime / 60));
  const seconds = addZero(roundTime - minutes * 60);

  function addZero(num) {
    return num < 10 ? `0${num}` : num;
  }

  return `${minutes} : ${seconds}`;
};

const onPlayerReady = () => {
  let interval;
  const durationSec = player.getDuration();

  $(".player__duration-estimate").text(formatTime(durationSec));

  if (typeof interval !== "undefined") {
    clearInterval(interval);
  }

  interval = setInterval(() => {
    const completedSec = player.getCurrentTime();
    const completedPercent = (completedSec / durationSec) * 100;

    $(".player__playback-button").css({
      left: `${completedPercent}%`
    });

    $(".player__duration-completed").text(formatTime(completedSec));
  }, 1000);
};

const onPlayerStateChange = event => {
  /*
    -1 (воспроизведение видео не начато)
    0 (воспроизведение видео завершено)
    1 (воспроизведение)
    2 (пауза)
    3 (буферизация)
    5 (видео подают реплики).
  */
  switch (event.data) {
    case 1:
      playerContainer.addClass("active");
      playerContainer.addClass("paused");
      break;

    case 2:
      playerContainer.removeClass("active");
      playerContainer.removeClass("paused");
      break;
  }
};

function onYouTubeIframeAPIReady() {
  player = new YT.Player("yt-player", {
    height: "392",
    width: "662",
    videoId: "6eHN3daGoYQ",
    events: {
      onReady: onPlayerReady,
      onStateChange: onPlayerStateChange
    },
    playerVars: {
      controls: 0,
      disablekb: 0,
      showinfo: 0,
      rel: 0,
      autoplay: 0,
      modestbranding: 0
    }
  });
}

eventsInit();

const mute = $('.player__mute');
const MAX_VOLUME = 100;
let soundLevel;

$('.player__volume-button').css({
  left: `${MAX_VOLUME}%`
});

$('.player__volume').click((e) => {
  const barVolume = $(e.currentTarget);
  const clickedVolumePosition = e.originalEvent.layerX;
  const newVolumePositionPercent = (clickedVolumePosition / barVolume.width()) * 100;
  const newSoundPosition = player.setVolume(newVolumePositionPercent);

  $('.player__volume-button').css({
    left: `${newVolumePositionPercent}%`
  });

  player.setVolume(newSoundPosition);
});

$(mute).click(e => {

  if (player.isMuted()) {
    $('.player__volume-button').css({
      left: `${soundLevel}%`
    });
    player.unMute();
  } else {
    soundLevel = player.getVolume();
    $('.player__volume-button').css({
      left: `0`
    });
    player.mute();
  }
});
/* })() */;; (function () {
  const findBlockByAlias = (alias) => {
    return $(".reviews__item").filter((idx, item) => {
      return $(item).attr("data-linked") === alias;
    });
  }

  $(".interactive-avatar__link").click(e => {
    e.preventDefault();

    const $this = $(e.currentTarget);
    const parent = $this.closest(".interactive-avatar");
    parent.addClass("active").siblings().removeClass("active");

    const target = $this.attr("data-open");
    const displayedItem = findBlockByAlias(target);
    displayedItem.addClass("active").siblings().removeClass("active");
  })
})()

;; (function () {
  const slider = $(".slider__list").bxSlider({
    pager: false,
    controls: false,
  });

  $('.arrow-right').click(e => {
    e.preventDefault();

    slider.goToNextSlide();
  });

  $('.arrow-left').click(e => {
    e.preventDefault();

    slider.goToPrevSlide();
  });
})();; (function () {
  const openItem = item => {
    const container = item.closest(".person");
    const content = container.find(".person__content");
    const contentBlock = content.find(".person__content-block");
    const contentBlockHeight = contentBlock.height();
    const triangle = container.find(".triangle");

    container.addClass("active");
    triangle.addClass("active");
    content.height(contentBlockHeight);
  }

  const closeAll = container => {
    const items = container.find(".person__content");
    const itemContainer = container.find(".person");
    const triangle = itemContainer.find(".triangle");

    itemContainer.removeClass("active");
    triangle.removeClass("active");
    items.height(0);
  }

  $(".person__name").click(e => {
    const $this = $(e.currentTarget);
    const container = $this.closest(".team");
    const itemContainer = $this.closest(".person");


    if (itemContainer.hasClass("active")) {
      closeAll(container);
    } else {
      closeAll(container);
      openItem($this);
    }
  })
})()
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhbmR5LWRyb3Bkb3duLmpzIiwiY2lyY3VsYXItc2xpZGVyLmpzIiwibWFwLmpzIiwibWVudS1hY2NvLmpzIiwibW9kYWwuanMiLCJvcHMuanMiLCJvdmVybGF5LW1lbnUuanMiLCJwbGF5ZXIuanMiLCJyZXZpZXdzLmpzIiwic2xpZGVyLmpzIiwidGVhbS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtDaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0N0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0NqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQ2pFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENDeElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtDckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdDdEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQ3BCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0NqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyI7IChmdW5jdGlvbiAoKSB7XHJcbiAgJChcIi5zbGlkZXJfX2Fib3V0LW1lbnVcIikubW91c2VvdmVyKGUgPT4ge1xyXG4gICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbiAgICBjb25zdCBkcm9wZG93biA9ICR0aGlzLmZpbmQoXCIuc2xpZGVyX19kcm9wZG93blwiKTtcclxuXHJcbiAgICAkdGhpcy5hZGRDbGFzcyhcInNsaWRlcl9fYWJvdXQtbWVudS0tYWN0aXZlXCIpO1xyXG4gICAgZHJvcGRvd24uYWRkQ2xhc3MoXCJkcm9wZG93bi0tYWN0aXZlXCIpO1xyXG4gIH0pO1xyXG5cclxuICAkKFwiLnNsaWRlcl9fYWJvdXQtbWVudVwiKS5tb3VzZW91dChlID0+IHtcclxuICAgIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgZHJvcGRvd24gPSAkdGhpcy5maW5kKFwiLnNsaWRlcl9fZHJvcGRvd25cIik7XHJcblxyXG4gICAgJHRoaXMucmVtb3ZlQ2xhc3MoXCJzbGlkZXJfX2Fib3V0LW1lbnUtLWFjdGl2ZVwiKTtcclxuICAgIGRyb3Bkb3duLnJlbW92ZUNsYXNzKFwiZHJvcGRvd24tLWFjdGl2ZVwiKTtcclxuICB9KTtcclxufSkoKSIsIjsgKGZ1bmN0aW9uICgpIHtcclxuICBjb25zdCBzbGlkZXJMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbGlkZXJfX2xpc3RcIik7XHJcbiAgY29uc3QgbGVmdEFycm93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNsZWZ0XCIpO1xyXG4gIGNvbnN0IHJpZ2h0QXJyb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3JpZ2h0XCIpO1xyXG5cclxuICBjb25zdCBsb29wID0gKGRpcmVjdGlvbiwgZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGlmIChkaXJlY3Rpb24gPT09IFwicmlnaHRcIikge1xyXG4gICAgICBzbGlkZXJMaXN0LmFwcGVuZENoaWxkKHNsaWRlckxpc3QuZmlyc3RFbGVtZW50Q2hpbGQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2xpZGVyTGlzdC5pbnNlcnRCZWZvcmUoc2xpZGVyTGlzdC5sYXN0RWxlbWVudENoaWxkLCBzbGlkZXJMaXN0LmZpcnN0RWxlbWVudENoaWxkKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGxlZnRBcnJvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgIGxvb3AoXCJsZWZ0XCIsIGUpO1xyXG4gIH0pO1xyXG5cclxuICByaWdodEFycm93LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgbG9vcChcInJpZ2h0XCIsIGUpO1xyXG4gIH0pO1xyXG59KSgpIiwiOyAoZnVuY3Rpb24gKCkge1xyXG4gIGxldCBteU1hcDtcclxuICBjb25zdCBpbml0ID0gKCkgPT4ge1xyXG4gICAgbXlNYXAgPSBuZXcgeW1hcHMuTWFwKFwibWFwXCIsIHtcclxuICAgICAgY2VudGVyOiBbNTUuNzUyNzYxLCAzNy41OTM5NTBdLFxyXG4gICAgICB6b29tOiAxNCxcclxuICAgICAgY29udHJvbHM6IFtdLFxyXG4gICAgfSk7XHJcblxyXG4gICAgbGV0IGNvb3JkcyA9IFtcclxuICAgICAgWzU1Ljc1ODY1NywgMzcuNTgyODM1XSxcclxuICAgICAgWzU1Ljc0MzA1NywgMzcuNTgxNzcwXSxcclxuICAgICAgWzU1Ljc1MDIzMiwgMzcuNjAzNjg5XSxcclxuICAgICAgWzU1Ljc1NDU4NSwgMzcuNjI1MzQzXSxcclxuICAgIF0sXHJcbiAgICAgIG15Q29sbGVjdGlvbiA9IG5ldyB5bWFwcy5HZW9PYmplY3RDb2xsZWN0aW9uKHt9LCB7XHJcbiAgICAgICAgZHJhZ2dhYmxlOiBmYWxzZSxcclxuICAgICAgICBpY29uTGF5b3V0OiAnZGVmYXVsdCNpbWFnZScsXHJcbiAgICAgICAgaWNvbkltYWdlSHJlZjogJy4vaW1nL2ljb25zL21hcmtlci5zdmcnLFxyXG4gICAgICAgIGljb25JbWFnZVNpemU6IFs0NiwgNTddLFxyXG4gICAgICAgIGljb25JbWFnZU9mZnNldDogWy0zNSwgLTUyXVxyXG4gICAgICB9KTtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvb3Jkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBteUNvbGxlY3Rpb24uYWRkKG5ldyB5bWFwcy5QbGFjZW1hcmsoY29vcmRzW2ldKSk7XHJcbiAgICB9XHJcblxyXG4gICAgbXlNYXAuZ2VvT2JqZWN0cy5hZGQobXlDb2xsZWN0aW9uKTtcclxuXHJcbiAgICBteU1hcC5iZWhhdmlvcnMuZGlzYWJsZSgnc2Nyb2xsWm9vbScpO1xyXG4gIH07XHJcblxyXG4gIHltYXBzLnJlYWR5KGluaXQpO1xyXG59KSgpIiwiOyAoZnVuY3Rpb24gKCkge1xyXG4gIGNvbnN0IGJsb2NrV2lkdGggPSBpdGVtID0+IHtcclxuICAgIGxldCBpdGVtV2lkdGggPSAwO1xyXG4gICAgY29uc3Qgc2NyZWVuV2lkdGggPSAkKHdpbmRvdykud2lkdGgoKTtcclxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGl0ZW0uY2xvc2VzdChcIi5wcm9kdWN0cy1tZW51XCIpO1xyXG4gICAgY29uc3QgdGl0bGVzQmxvY2tzID0gY29udGFpbmVyLmZpbmQoXCIucHJvZHVjdHMtbWVudV9fdGl0bGVcIik7XHJcbiAgICBjb25zdCB0aXRsZXNXaWR0aCA9IHRpdGxlc0Jsb2Nrcy53aWR0aCgpICogdGl0bGVzQmxvY2tzLmxlbmd0aDtcclxuXHJcbiAgICBjb25zdCB0ZXh0Q29udGFpbmVyID0gaXRlbS5maW5kKFwiLnByb2R1Y3RzLW1lbnVfX2NvbnRhaW5lclwiKTtcclxuICAgIGNvbnN0IHBhZGRpbmdMZWZ0ID0gcGFyc2VJbnQodGV4dENvbnRhaW5lci5jc3MoXCJwYWRkaW5nLWxlZnRcIikpO1xyXG4gICAgY29uc3QgcGFkZGluZ1JpZ2h0ID0gcGFyc2VJbnQodGV4dENvbnRhaW5lci5jc3MoXCJwYWRkaW5nLXJpZ2h0XCIpKTtcclxuXHJcbiAgICBjb25zdCBpc01vYmlsZSA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNzY4cHgpXCIpLm1hdGNoZXM7XHJcblxyXG4gICAgaWYgKGlzTW9iaWxlKSB7XHJcbiAgICAgIGl0ZW1XaWR0aCA9IHNjcmVlbldpZHRoIC0gdGl0bGVzV2lkdGg7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpdGVtV2lkdGggPSA1MDA7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgY29udGFpbmVyOiBpdGVtV2lkdGgsXHJcbiAgICAgIHRleHRDb250YWluZXI6IGl0ZW1XaWR0aCAtIHBhZGRpbmdSaWdodCAtIHBhZGRpbmdMZWZ0XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb25zdCBjbG9zZUFsbE1lbnVJdGVtID0gY29udGFpbmVyID0+IHtcclxuICAgIGNvbnN0IGl0ZW1zID0gY29udGFpbmVyLmZpbmQoXCIucHJvZHVjdHMtbWVudV9faXRlbVwiKTtcclxuICAgIGNvbnN0IGNvbnRlbnQgPSBjb250YWluZXIuZmluZChcIi5wcm9kdWN0cy1tZW51X19jb250ZW50XCIpO1xyXG5cclxuICAgIGl0ZW1zLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgY29udGVudC53aWR0aCgwKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IG9wZW5Qcm9kdWN0TWVudUl0ZW0gPSBpdGVtID0+IHtcclxuICAgIGNvbnN0IGhpZGRlbkNvbnRlbnQgPSBpdGVtLmZpbmQoXCIucHJvZHVjdHMtbWVudV9fY29udGVudFwiKTtcclxuICAgIGNvbnN0IHcgPSBibG9ja1dpZHRoKGl0ZW0pO1xyXG4gICAgY29uc3QgdGV4dEJsb2NrID0gaXRlbS5maW5kKFwiLnByb2R1Y3RzLW1lbnVfX2NvbnRhaW5lclwiKTtcclxuXHJcbiAgICBpdGVtLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgaGlkZGVuQ29udGVudC53aWR0aCh3LmNvbnRhaW5lcik7XHJcbiAgICB0ZXh0QmxvY2sud2lkdGgody50ZXh0Q29udGFpbmVyKTtcclxuICB9XHJcblxyXG4gICQoXCIucHJvZHVjdHMtbWVudV9fdGl0bGVcIikuY2xpY2soZSA9PiB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbiAgICBjb25zdCBpdGVtID0gJHRoaXMuY2xvc2VzdChcIi5wcm9kdWN0cy1tZW51X19pdGVtXCIpO1xyXG4gICAgY29uc3QgaXRlbU9wZW5lZCA9IGl0ZW0uaGFzQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLnByb2R1Y3RzLW1lbnVcIik7XHJcblxyXG4gICAgaWYgKGl0ZW1PcGVuZWQpIHtcclxuICAgICAgY2xvc2VBbGxNZW51SXRlbShjb250YWluZXIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY2xvc2VBbGxNZW51SXRlbShjb250YWluZXIpO1xyXG4gICAgICBvcGVuUHJvZHVjdE1lbnVJdGVtKGl0ZW0pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KSgpIiwiOyAoZnVuY3Rpb24gKCkge1xyXG4gIGNvbnN0IHZhbGlkYXRlRmllbGQgPSAoZm9ybSwgZmllbGRzQXJyYXkpID0+IHtcclxuICAgIGZpZWxkc0FycmF5LmZvckVhY2goZmllbGQgPT4ge1xyXG4gICAgICBmaWVsZC5yZW1vdmVDbGFzcyhcImlucHV0LWVycm9yXCIpO1xyXG4gICAgICBpZiAoZmllbGQudmFsKCkudHJpbSgpID09PSBcIlwiKSB7XHJcbiAgICAgICAgZmllbGQuYWRkQ2xhc3MoXCJpbnB1dC1lcnJvclwiKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgZXJyb3JGaWVsZHMgPSBmb3JtLmZpbmQoXCIuaW5wdXQtZXJyb3JcIik7XHJcbiAgICByZXR1cm4gZXJyb3JGaWVsZHMubGVuZ3RoID09PSAwO1xyXG4gIH1cclxuXHJcbiAgJChcIi5mb3JtXCIpLnN1Ym1pdChlID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBjb25zdCBmb3JtID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgbmFtZSA9IGZvcm0uZmluZChcIltuYW1lPSduYW1lJ11cIik7XHJcbiAgICBjb25zdCBwaG9uZSA9IGZvcm0uZmluZChcIltuYW1lPSdwaG9uZSddXCIpO1xyXG4gICAgY29uc3QgY29tbWVudCA9IGZvcm0uZmluZChcIltuYW1lPSdjb21tZW50J11cIik7XHJcbiAgICBjb25zdCB0byA9IGZvcm0uZmluZChcIltuYW1lPSd0byddXCIpO1xyXG5cclxuICAgIGNvbnN0IG1vZGFsID0gJChcIiNtb2RhbFwiKTtcclxuICAgIGNvbnN0IGNvbnRlbnQgPSBtb2RhbC5maW5kKFwiLm1vZGFsX19jb250ZW50XCIpO1xyXG4gICAgY29udGVudC5yZW1vdmVDbGFzcyhcImVycm9yLW1vZGFsXCIpO1xyXG5cclxuICAgIGNvbnN0IGlzVmFsaWQgPSB2YWxpZGF0ZUZpZWxkKGZvcm0sIFtuYW1lLCBwaG9uZSwgY29tbWVudCwgdG9dKTtcclxuXHJcbiAgICBpZiAoaXNWYWxpZCkge1xyXG4gICAgICBjb25zdCByZXF1ZXN0ID0gJC5hamF4KHtcclxuICAgICAgICB1cmw6IFwiaHR0cHM6Ly93ZWJkZXYtYXBpLmxvZnRzY2hvb2wuY29tL3NlbmRtYWlsXCIsXHJcbiAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBuYW1lOiBuYW1lLnZhbCgpLFxyXG4gICAgICAgICAgcGhvbmU6IHBob25lLnZhbCgpLFxyXG4gICAgICAgICAgY29tbWVudDogY29tbWVudC52YWwoKSxcclxuICAgICAgICAgIHRvOiB0by52YWwoKVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXF1ZXN0LmRvbmUoKGRhdGEpID0+IHtcclxuICAgICAgICBjb250ZW50LnRleHQoZGF0YS5tZXNzYWdlKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXF1ZXN0LmZhaWwoKGRhdGEpID0+IHtcclxuICAgICAgICBjb25zdCBtZXNzYWdlID0gZGF0YS5yZXNwb25zZUpTT04ubWVzc2FnZTtcclxuICAgICAgICBjb250ZW50LnRleHQobWVzc2FnZSk7XHJcbiAgICAgICAgY29udGVudC5hZGRDbGFzcyhcImVycm9yLW1vZGFsXCIpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJlcXVlc3QuYWx3YXlzKCgpID0+IHtcclxuICAgICAgICAkLmZhbmN5Ym94Lm9wZW4oe1xyXG4gICAgICAgICAgc3JjOiBcIiNtb2RhbFwiLFxyXG4gICAgICAgICAgdHlwZTogXCJpbmxpbmVcIlxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgJChcIi5hcHAtc3VibWl0LW1vZGFsXCIpLmNsaWNrKGUgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICQuZmFuY3lib3guY2xvc2UoKTtcclxuICB9KTtcclxufSkoKSIsIjsgKGZ1bmN0aW9uICgpIHtcclxuICBjb25zdCBzZWN0aW9ucyA9ICQoXCJzZWN0aW9uXCIpO1xyXG4gIGNvbnN0IGRpc3BsYXkgPSAkKFwiLm1haW5jb250ZW50XCIpO1xyXG4gIGNvbnN0IHNpZGVNZW51ID0gJChcIi5maXhlZC1tZW51XCIpO1xyXG4gIGNvbnN0IG1lbnVJdGVtcyA9IHNpZGVNZW51LmZpbmQoXCIuZml4ZWQtbWVudV9faXRlbVwiKTtcclxuXHJcbiAgY29uc3QgbW9iaWxlRGV0ZWN0ID0gbmV3IE1vYmlsZURldGVjdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7XHJcbiAgY29uc3QgaXNNb2JpbGUgPSBtb2JpbGVEZXRlY3QubW9iaWxlKCk7XHJcblxyXG4gIGxldCBpblNjcm9sbCA9IGZhbHNlO1xyXG5cclxuICBzZWN0aW9ucy5maXJzdCgpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG5cclxuICBjb25zdCBjb3VudFNlY3Rpb25Qb3NpdGlvbiA9IHNlY3Rpb25FcSA9PiB7XHJcbiAgICBjb25zdCBwb3NpdGlvbiA9IHNlY3Rpb25FcSAqIC0xMDA7XHJcblxyXG4gICAgaWYgKGlzTmFOKHBvc2l0aW9uKSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwi0J/QtdGA0LXQtNCw0L3QviDQvdC1INCy0LXRgNC90L7QtSDQt9C90LDRh9C10L3QuNC1INCyIGNvdW50U2VjdGlvblBvc2l0aW9uXCIpO1xyXG4gICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICAgIHJldHVybiBwb3NpdGlvbjtcclxuICB9XHJcblxyXG4gIGNvbnN0IGNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24gPSBzZWN0aW9uRXEgPT4ge1xyXG4gICAgY29uc3QgY3VycmVudFNlY3Rpb24gPSBzZWN0aW9ucy5lcShzZWN0aW9uRXEpO1xyXG4gICAgY29uc3QgbWVudVRoZW1lID0gY3VycmVudFNlY3Rpb24uYXR0cihcImRhdGEtc2lkZW1lbnUtdGhlbWVcIik7XHJcbiAgICBjb25zdCBhY3RpdmVDbGFzcyA9IFwiZml4ZWQtbWVudS0tYmxhY2tcIjtcclxuXHJcbiAgICBpZiAobWVudVRoZW1lID09PSBcImJsYWNrXCIpIHtcclxuICAgICAgc2lkZU1lbnUuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2lkZU1lbnUucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY29uc3QgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0gPSAoaXRlbXMsIGl0ZW1FcSwgYWN0aXZlQ2xhc3MpID0+IHtcclxuICAgIGl0ZW1zLmVxKGl0ZW1FcSkuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgcGVyZm9ybVRyYW5zaXRpb24gPSBzZWN0aW9uRXEgPT4ge1xyXG4gICAgaWYgKGluU2Nyb2xsKSByZXR1cm47XHJcbiAgICBpblNjcm9sbCA9IHRydWU7XHJcblxyXG4gICAgY29uc3QgdHJhbnNpdGlvbk92ZXIgPSAxMDAwO1xyXG4gICAgY29uc3QgbW91c2VJbmVydGlhT3ZlciA9IDMwMDtcclxuXHJcbiAgICBjb25zdCBwb3NpdGlvbiA9IGNvdW50U2VjdGlvblBvc2l0aW9uKHNlY3Rpb25FcSk7XHJcblxyXG4gICAgY2hhbmdlTWVudVRoZW1lRm9yU2VjdGlvbihzZWN0aW9uRXEpO1xyXG5cclxuICAgIGRpc3BsYXkuY3NzKHtcclxuICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgke3Bvc2l0aW9ufSUpYFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0oc2VjdGlvbnMsIHNlY3Rpb25FcSwgXCJhY3RpdmVcIik7XHJcbiAgICByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbShtZW51SXRlbXMsIHNlY3Rpb25FcSwgXCJmaXhlZC1tZW51X19pdGVtLS1hY3RpdmVcIik7XHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIGluU2Nyb2xsID0gZmFsc2U7XHJcbiAgICB9LCB0cmFuc2l0aW9uT3ZlciArIG1vdXNlSW5lcnRpYU92ZXIpO1xyXG4gIH1cclxuXHJcbiAgY29uc3Qgdmlld3BvcnRTY3JvbGxlciA9ICgpID0+IHtcclxuICAgIGNvbnN0IGFjdGl2ZVNlY3Rpb24gPSBzZWN0aW9ucy5maWx0ZXIoXCIuYWN0aXZlXCIpO1xyXG4gICAgY29uc3QgbmV4dFNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLm5leHQoKTtcclxuICAgIGNvbnN0IHByZXZTZWN0aW9uID0gYWN0aXZlU2VjdGlvbi5wcmV2KCk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmV4dCgpIHtcclxuICAgICAgICBpZiAobmV4dFNlY3Rpb24ubGVuZ3RoKSB7XHJcbiAgICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihuZXh0U2VjdGlvbi5pbmRleCgpKVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgcHJldigpIHtcclxuICAgICAgICBpZiAocHJldlNlY3Rpb24ubGVuZ3RoKSB7XHJcbiAgICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihwcmV2U2VjdGlvbi5pbmRleCgpKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgJCh3aW5kb3cpLm9uKFwid2hlZWxcIiwgZSA9PiB7XHJcbiAgICBjb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xyXG4gICAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7XHJcblxyXG4gICAgaWYgKGRlbHRhWSA+IDApIHtcclxuICAgICAgc2Nyb2xsZXIubmV4dCgpO1xyXG4gICAgfSBlbHNlIGlmIChkZWx0YVkgPCAwKSB7XHJcbiAgICAgIHNjcm9sbGVyLnByZXYoKTtcclxuICAgIH1cclxuICB9KVxyXG5cclxuICAkKHdpbmRvdykub24oXCJrZXlkb3duXCIsIGUgPT4ge1xyXG4gICAgY29uc3QgdGFnTmFtZSA9IGUudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcclxuICAgIGNvbnN0IHVzZXJUeXBpbmdJbklucHV0cyA9IHRhZ05hbWUgPT09IFwiaW5wdXRcIiB8fCB0YWdOYW1lID09PSBcInRleHRhcmVhXCI7XHJcbiAgICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcclxuXHJcbiAgICBpZiAodXNlclR5cGluZ0luSW5wdXRzKSByZXR1cm47XHJcbiAgICBzd2l0Y2ggKGUua2V5Q29kZSkge1xyXG4gICAgICBjYXNlIDM4OlxyXG4gICAgICAgIHNjcm9sbGVyLnByZXYoKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgNDA6XHJcbiAgICAgICAgc2Nyb2xsZXIubmV4dCgpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH0pXHJcblxyXG4gICQoXCIud3JhcHBlclwiKS5vbihcInRvdWNobW92ZVwiLCBlID0+IGUucHJldmVudERlZmF1bHQoKSk7XHJcblxyXG4gICQoXCJbZGF0YS1zY3JvbGwtdG9dXCIpLmNsaWNrKGUgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgdGFyZ2V0ID0gJHRoaXMuYXR0cihcImRhdGEtc2Nyb2xsLXRvXCIpO1xyXG4gICAgY29uc3QgcmVxU2VjdGlvbiA9ICQoYFtkYXRhLXNlY3Rpb24taWQ9JHt0YXJnZXR9XWApO1xyXG5cclxuICAgIHBlcmZvcm1UcmFuc2l0aW9uKHJlcVNlY3Rpb24uaW5kZXgoKSk7XHJcbiAgfSlcclxuXHJcbiAgaWYgKGlzTW9iaWxlKSB7XHJcbiAgICAvLyAgaHR0cHM6Ly9naXRodWIuY29tL21hdHRicnlzb24vVG91Y2hTd2lwZS1KcXVlcnktUGx1Z2luXHJcbiAgICAkKFwiYm9keVwiKS5zd2lwZSh7XHJcbiAgICAgIHN3aXBlOiBmdW5jdGlvbiAoZXZlbnQsIGRpcmVjdGlvbikge1xyXG4gICAgICAgIGNvbnN0IHNjcm9sbGVyID0gdmlld3BvcnRTY3JvbGxlcigpO1xyXG4gICAgICAgIGxldCBzY3JvbGxEaXJlY3Rpb24gPSBcIlwiO1xyXG5cclxuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSBcInVwXCIpIHNjcm9sbERpcmVjdGlvbiA9IFwibmV4dFwiO1xyXG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT09IFwiZG93blwiKSBzY3JvbGxEaXJlY3Rpb24gPSBcInByZXZcIjtcclxuXHJcbiAgICAgICAgaWYgKHNjcm9sbERpcmVjdGlvbiAhPT0gXCJcIikgc2Nyb2xsZXJbc2Nyb2xsRGlyZWN0aW9uXSgpO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxufSkoKVxyXG4iLCI7IChmdW5jdGlvbiAoKSB7XHJcbiAgY29uc3QgaGFtYnVyZ2VyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oYW1idXJnZXJcIik7XHJcbiAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheVwiKTtcclxuICBjb25zdCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJvZHlcIik7XHJcbiAgY29uc3QgbGlua3MgPSAkKFwiLm92ZXJsYXktbWVudV9fbGlua1wiKTtcclxuXHJcbiAgaGFtYnVyZ2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBlID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBoYW1idXJnZXIuY2xhc3NMaXN0LnRvZ2dsZShcImhhbWJ1cmdlci0tYWN0aXZlXCIpO1xyXG4gICAgb3ZlcmxheS5jbGFzc0xpc3QudG9nZ2xlKFwib3ZlcmxheS0tYWN0aXZlXCIpO1xyXG4gICAgYm9keS5jbGFzc0xpc3QudG9nZ2xlKFwiYm9keS0tYWN0aXZlXCIpO1xyXG4gIH0pO1xyXG5cclxuICAkKGxpbmtzKS5lYWNoKChsaW5rKSA9PiB7XHJcbiAgICBsaW5rcy5jbGljayhlID0+IHtcclxuICAgICAgJChcIi5vdmVybGF5XCIpLnJlbW92ZUNsYXNzKFwib3ZlcmxheS0tYWN0aXZlXCIpO1xyXG4gICAgICAkKGJvZHkpLnJlbW92ZUNsYXNzKFwiYm9keS0tYWN0aXZlXCIpO1xyXG4gICAgICAkKFwiLmhhbWJ1cmdlclwiKS5yZW1vdmVDbGFzcyhcImhhbWJ1cmdlci0tYWN0aXZlXCIpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pKCkiLCIvKiA7IChmdW5jdGlvbiAoKSB7ICovXHJcbmxldCBwbGF5ZXI7XHJcblxyXG5jb25zdCBwbGF5ZXJDb250YWluZXIgPSAkKFwiLnBsYXllclwiKTtcclxuXHJcbmxldCBldmVudHNJbml0ID0gKCkgPT4ge1xyXG4gICQoXCIucGxheWVyX19zdGFydFwiKS5jbGljayhlID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBpZiAocGxheWVyQ29udGFpbmVyLmhhc0NsYXNzKFwicGF1c2VkXCIpKSB7XHJcbiAgICAgIHBsYXllci5wYXVzZVZpZGVvKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBwbGF5ZXIucGxheVZpZGVvKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gICQoXCIucGxheWVyX19wbGF5YmFja1wiKS5jbGljayhlID0+IHtcclxuICAgIGNvbnN0IGJhciA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgIGNvbnN0IGNsaWNrZWRQb3NpdGlvbiA9IGUub3JpZ2luYWxFdmVudC5sYXllclg7XHJcbiAgICBjb25zdCBuZXdCdXR0b25Qb3NpdGlvblBlcmNlbnQgPSAoY2xpY2tlZFBvc2l0aW9uIC8gYmFyLndpZHRoKCkpICogMTAwO1xyXG4gICAgY29uc3QgbmV3UGxheWJhY2tQb3NpdGlvblNlYyA9XHJcbiAgICAgIChwbGF5ZXIuZ2V0RHVyYXRpb24oKSAvIDEwMCkgKiBuZXdCdXR0b25Qb3NpdGlvblBlcmNlbnQ7XHJcblxyXG4gICAgJChcIi5wbGF5ZXJfX3BsYXliYWNrLWJ1dHRvblwiKS5jc3Moe1xyXG4gICAgICBsZWZ0OiBgJHtuZXdCdXR0b25Qb3NpdGlvblBlcmNlbnR9JWBcclxuICAgIH0pO1xyXG5cclxuICAgIHBsYXllci5zZWVrVG8obmV3UGxheWJhY2tQb3NpdGlvblNlYyk7XHJcbiAgfSk7XHJcblxyXG4gICQoXCIucGxheWVyX19zcGxhc2hcIikuY2xpY2soZSA9PiB7XHJcbiAgICBwbGF5ZXIucGxheVZpZGVvKCk7XHJcbiAgfSlcclxufTtcclxuXHJcbmNvbnN0IGZvcm1hdFRpbWUgPSB0aW1lU2VjID0+IHtcclxuICBjb25zdCByb3VuZFRpbWUgPSBNYXRoLnJvdW5kKHRpbWVTZWMpO1xyXG5cclxuICBjb25zdCBtaW51dGVzID0gYWRkWmVybyhNYXRoLmZsb29yKHJvdW5kVGltZSAvIDYwKSk7XHJcbiAgY29uc3Qgc2Vjb25kcyA9IGFkZFplcm8ocm91bmRUaW1lIC0gbWludXRlcyAqIDYwKTtcclxuXHJcbiAgZnVuY3Rpb24gYWRkWmVybyhudW0pIHtcclxuICAgIHJldHVybiBudW0gPCAxMCA/IGAwJHtudW19YCA6IG51bTtcclxuICB9XHJcblxyXG4gIHJldHVybiBgJHttaW51dGVzfSA6ICR7c2Vjb25kc31gO1xyXG59O1xyXG5cclxuY29uc3Qgb25QbGF5ZXJSZWFkeSA9ICgpID0+IHtcclxuICBsZXQgaW50ZXJ2YWw7XHJcbiAgY29uc3QgZHVyYXRpb25TZWMgPSBwbGF5ZXIuZ2V0RHVyYXRpb24oKTtcclxuXHJcbiAgJChcIi5wbGF5ZXJfX2R1cmF0aW9uLWVzdGltYXRlXCIpLnRleHQoZm9ybWF0VGltZShkdXJhdGlvblNlYykpO1xyXG5cclxuICBpZiAodHlwZW9mIGludGVydmFsICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICBjbGVhckludGVydmFsKGludGVydmFsKTtcclxuICB9XHJcblxyXG4gIGludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgY29uc3QgY29tcGxldGVkU2VjID0gcGxheWVyLmdldEN1cnJlbnRUaW1lKCk7XHJcbiAgICBjb25zdCBjb21wbGV0ZWRQZXJjZW50ID0gKGNvbXBsZXRlZFNlYyAvIGR1cmF0aW9uU2VjKSAqIDEwMDtcclxuXHJcbiAgICAkKFwiLnBsYXllcl9fcGxheWJhY2stYnV0dG9uXCIpLmNzcyh7XHJcbiAgICAgIGxlZnQ6IGAke2NvbXBsZXRlZFBlcmNlbnR9JWBcclxuICAgIH0pO1xyXG5cclxuICAgICQoXCIucGxheWVyX19kdXJhdGlvbi1jb21wbGV0ZWRcIikudGV4dChmb3JtYXRUaW1lKGNvbXBsZXRlZFNlYykpO1xyXG4gIH0sIDEwMDApO1xyXG59O1xyXG5cclxuY29uc3Qgb25QbGF5ZXJTdGF0ZUNoYW5nZSA9IGV2ZW50ID0+IHtcclxuICAvKlxyXG4gICAgLTEgKNCy0L7RgdC/0YDQvtC40LfQstC10LTQtdC90LjQtSDQstC40LTQtdC+INC90LUg0L3QsNGH0LDRgtC+KVxyXG4gICAgMCAo0LLQvtGB0L/RgNC+0LjQt9Cy0LXQtNC10L3QuNC1INCy0LjQtNC10L4g0LfQsNCy0LXRgNGI0LXQvdC+KVxyXG4gICAgMSAo0LLQvtGB0L/RgNC+0LjQt9Cy0LXQtNC10L3QuNC1KVxyXG4gICAgMiAo0L/QsNGD0LfQsClcclxuICAgIDMgKNCx0YPRhNC10YDQuNC30LDRhtC40Y8pXHJcbiAgICA1ICjQstC40LTQtdC+INC/0L7QtNCw0Y7RgiDRgNC10L/Qu9C40LrQuCkuXHJcbiAgKi9cclxuICBzd2l0Y2ggKGV2ZW50LmRhdGEpIHtcclxuICAgIGNhc2UgMTpcclxuICAgICAgcGxheWVyQ29udGFpbmVyLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICBwbGF5ZXJDb250YWluZXIuYWRkQ2xhc3MoXCJwYXVzZWRcIik7XHJcbiAgICAgIGJyZWFrO1xyXG5cclxuICAgIGNhc2UgMjpcclxuICAgICAgcGxheWVyQ29udGFpbmVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICBwbGF5ZXJDb250YWluZXIucmVtb3ZlQ2xhc3MoXCJwYXVzZWRcIik7XHJcbiAgICAgIGJyZWFrO1xyXG4gIH1cclxufTtcclxuXHJcbmZ1bmN0aW9uIG9uWW91VHViZUlmcmFtZUFQSVJlYWR5KCkge1xyXG4gIHBsYXllciA9IG5ldyBZVC5QbGF5ZXIoXCJ5dC1wbGF5ZXJcIiwge1xyXG4gICAgaGVpZ2h0OiBcIjM5MlwiLFxyXG4gICAgd2lkdGg6IFwiNjYyXCIsXHJcbiAgICB2aWRlb0lkOiBcIjZlSE4zZGFHb1lRXCIsXHJcbiAgICBldmVudHM6IHtcclxuICAgICAgb25SZWFkeTogb25QbGF5ZXJSZWFkeSxcclxuICAgICAgb25TdGF0ZUNoYW5nZTogb25QbGF5ZXJTdGF0ZUNoYW5nZVxyXG4gICAgfSxcclxuICAgIHBsYXllclZhcnM6IHtcclxuICAgICAgY29udHJvbHM6IDAsXHJcbiAgICAgIGRpc2FibGVrYjogMCxcclxuICAgICAgc2hvd2luZm86IDAsXHJcbiAgICAgIHJlbDogMCxcclxuICAgICAgYXV0b3BsYXk6IDAsXHJcbiAgICAgIG1vZGVzdGJyYW5kaW5nOiAwXHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV2ZW50c0luaXQoKTtcclxuXHJcbmNvbnN0IG11dGUgPSAkKCcucGxheWVyX19tdXRlJyk7XHJcbmNvbnN0IE1BWF9WT0xVTUUgPSAxMDA7XHJcbmxldCBzb3VuZExldmVsO1xyXG5cclxuJCgnLnBsYXllcl9fdm9sdW1lLWJ1dHRvbicpLmNzcyh7XHJcbiAgbGVmdDogYCR7TUFYX1ZPTFVNRX0lYFxyXG59KTtcclxuXHJcbiQoJy5wbGF5ZXJfX3ZvbHVtZScpLmNsaWNrKChlKSA9PiB7XHJcbiAgY29uc3QgYmFyVm9sdW1lID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gIGNvbnN0IGNsaWNrZWRWb2x1bWVQb3NpdGlvbiA9IGUub3JpZ2luYWxFdmVudC5sYXllclg7XHJcbiAgY29uc3QgbmV3Vm9sdW1lUG9zaXRpb25QZXJjZW50ID0gKGNsaWNrZWRWb2x1bWVQb3NpdGlvbiAvIGJhclZvbHVtZS53aWR0aCgpKSAqIDEwMDtcclxuICBjb25zdCBuZXdTb3VuZFBvc2l0aW9uID0gcGxheWVyLnNldFZvbHVtZShuZXdWb2x1bWVQb3NpdGlvblBlcmNlbnQpO1xyXG5cclxuICAkKCcucGxheWVyX192b2x1bWUtYnV0dG9uJykuY3NzKHtcclxuICAgIGxlZnQ6IGAke25ld1ZvbHVtZVBvc2l0aW9uUGVyY2VudH0lYFxyXG4gIH0pO1xyXG5cclxuICBwbGF5ZXIuc2V0Vm9sdW1lKG5ld1NvdW5kUG9zaXRpb24pO1xyXG59KTtcclxuXHJcbiQobXV0ZSkuY2xpY2soZSA9PiB7XHJcblxyXG4gIGlmIChwbGF5ZXIuaXNNdXRlZCgpKSB7XHJcbiAgICAkKCcucGxheWVyX192b2x1bWUtYnV0dG9uJykuY3NzKHtcclxuICAgICAgbGVmdDogYCR7c291bmRMZXZlbH0lYFxyXG4gICAgfSk7XHJcbiAgICBwbGF5ZXIudW5NdXRlKCk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHNvdW5kTGV2ZWwgPSBwbGF5ZXIuZ2V0Vm9sdW1lKCk7XHJcbiAgICAkKCcucGxheWVyX192b2x1bWUtYnV0dG9uJykuY3NzKHtcclxuICAgICAgbGVmdDogYDBgXHJcbiAgICB9KTtcclxuICAgIHBsYXllci5tdXRlKCk7XHJcbiAgfVxyXG59KTtcclxuLyogfSkoKSAqLyIsIjsgKGZ1bmN0aW9uICgpIHtcclxuICBjb25zdCBmaW5kQmxvY2tCeUFsaWFzID0gKGFsaWFzKSA9PiB7XHJcbiAgICByZXR1cm4gJChcIi5yZXZpZXdzX19pdGVtXCIpLmZpbHRlcigoaWR4LCBpdGVtKSA9PiB7XHJcbiAgICAgIHJldHVybiAkKGl0ZW0pLmF0dHIoXCJkYXRhLWxpbmtlZFwiKSA9PT0gYWxpYXM7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gICQoXCIuaW50ZXJhY3RpdmUtYXZhdGFyX19saW5rXCIpLmNsaWNrKGUgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgcGFyZW50ID0gJHRoaXMuY2xvc2VzdChcIi5pbnRlcmFjdGl2ZS1hdmF0YXJcIik7XHJcbiAgICBwYXJlbnQuYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuXHJcbiAgICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKFwiZGF0YS1vcGVuXCIpO1xyXG4gICAgY29uc3QgZGlzcGxheWVkSXRlbSA9IGZpbmRCbG9ja0J5QWxpYXModGFyZ2V0KTtcclxuICAgIGRpc3BsYXllZEl0ZW0uYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICB9KVxyXG59KSgpXHJcblxyXG4iLCI7IChmdW5jdGlvbiAoKSB7XHJcbiAgY29uc3Qgc2xpZGVyID0gJChcIi5zbGlkZXJfX2xpc3RcIikuYnhTbGlkZXIoe1xyXG4gICAgcGFnZXI6IGZhbHNlLFxyXG4gICAgY29udHJvbHM6IGZhbHNlLFxyXG4gIH0pO1xyXG5cclxuICAkKCcuYXJyb3ctcmlnaHQnKS5jbGljayhlID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBzbGlkZXIuZ29Ub05leHRTbGlkZSgpO1xyXG4gIH0pO1xyXG5cclxuICAkKCcuYXJyb3ctbGVmdCcpLmNsaWNrKGUgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIHNsaWRlci5nb1RvUHJldlNsaWRlKCk7XHJcbiAgfSk7XHJcbn0pKCkiLCI7IChmdW5jdGlvbiAoKSB7XHJcbiAgY29uc3Qgb3Blbkl0ZW0gPSBpdGVtID0+IHtcclxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGl0ZW0uY2xvc2VzdChcIi5wZXJzb25cIik7XHJcbiAgICBjb25zdCBjb250ZW50ID0gY29udGFpbmVyLmZpbmQoXCIucGVyc29uX19jb250ZW50XCIpO1xyXG4gICAgY29uc3QgY29udGVudEJsb2NrID0gY29udGVudC5maW5kKFwiLnBlcnNvbl9fY29udGVudC1ibG9ja1wiKTtcclxuICAgIGNvbnN0IGNvbnRlbnRCbG9ja0hlaWdodCA9IGNvbnRlbnRCbG9jay5oZWlnaHQoKTtcclxuICAgIGNvbnN0IHRyaWFuZ2xlID0gY29udGFpbmVyLmZpbmQoXCIudHJpYW5nbGVcIik7XHJcblxyXG4gICAgY29udGFpbmVyLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgdHJpYW5nbGUuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICBjb250ZW50LmhlaWdodChjb250ZW50QmxvY2tIZWlnaHQpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgY2xvc2VBbGwgPSBjb250YWluZXIgPT4ge1xyXG4gICAgY29uc3QgaXRlbXMgPSBjb250YWluZXIuZmluZChcIi5wZXJzb25fX2NvbnRlbnRcIik7XHJcbiAgICBjb25zdCBpdGVtQ29udGFpbmVyID0gY29udGFpbmVyLmZpbmQoXCIucGVyc29uXCIpO1xyXG4gICAgY29uc3QgdHJpYW5nbGUgPSBpdGVtQ29udGFpbmVyLmZpbmQoXCIudHJpYW5nbGVcIik7XHJcblxyXG4gICAgaXRlbUNvbnRhaW5lci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgIHRyaWFuZ2xlLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgaXRlbXMuaGVpZ2h0KDApO1xyXG4gIH1cclxuXHJcbiAgJChcIi5wZXJzb25fX25hbWVcIikuY2xpY2soZSA9PiB7XHJcbiAgICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgIGNvbnN0IGNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIudGVhbVwiKTtcclxuICAgIGNvbnN0IGl0ZW1Db250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLnBlcnNvblwiKTtcclxuXHJcblxyXG4gICAgaWYgKGl0ZW1Db250YWluZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHtcclxuICAgICAgY2xvc2VBbGwoY29udGFpbmVyKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNsb3NlQWxsKGNvbnRhaW5lcik7XHJcbiAgICAgIG9wZW5JdGVtKCR0aGlzKTtcclxuICAgIH1cclxuICB9KVxyXG59KSgpIl19
